<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: GenericDao</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: GenericDao</h1>

    




<section>

<header>
    
        <h2>GenericDao</h2>
        
            <div class="class-description">Generic data-access object for simple CRUD operations.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="GenericDao"><span class="type-signature"></span>new GenericDao<span class="signature">(dataContext, tableName)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Initialize the DAO.  Note that the db is expected to be connected
before any of this class's methods are used.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dataContext</code></td>
            

            <td class="type">
            
                
<span class="param-type">DataContext</span>


            
            </td>

            

            

            <td class="description last">A DataContext instance that is used
to run queries.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tableName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The name of the table that this DAO operates on.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line10">line 10</a>
    </li></ul></dd>
    

    

    

    
</dl>
















    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="create"><span class="type-signature"></span>create<span class="signature">(resource)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Generic create method that validates a model using an InsertValidator
and then inserts the model.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A model to create.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line322">line 322</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Same as createIf.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="createIf"><span class="type-signature"></span>createIf<span class="signature">(resource, condition)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Create a resource if a condition resolves successfully.  Note
that prior to invoking the condition the resource is validated
using an InsertValidator.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A model to create.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>condition</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="GenericDao.html#~conditionCallback">GenericDao~conditionCallback</a></span>


            
            </td>

            

            

            <td class="description last">A function that
returns a promise.  If the promise is resolved then the model is
created.  resource is passed to condition.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line312">line 312</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is:
1) Resolved with the model if the model is valid and the
   condition is resolved.  The model will be updated with
   the new ID if possible.
2) Rejected with a ValidationErrorList if the model is invalid.
3) Rejected with condition's promise if condition is rejected.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="delete"><span class="type-signature"></span>delete<span class="signature">(resource)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Generic delete method that validates a model using a DeleteValidator
and then deletes it by ID.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A model to delete by ID.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line364">line 364</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is:
1) Resolved with the model if the model is valid and deleted.
2) Rejected with a ValidationErrorList if the model is invalid.
3) Rejected with a NotFoundError instance if no records are affected
   by the delete attempt.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="isUnique"><span class="type-signature"></span>isUnique<span class="signature">(where, params, onDupe)</span><span class="type-signature"> &rarr; {Promise.&lt;bool>}</span></h4>

    



<div class="description">
    Helper function to check that something is unique.  This is useful
before creating or updating a record.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>where</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An optional where condition.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Query parameters for the where condition.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onDupe</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="GenericDao.html#~errorCallback">GenericDao~errorCallback</a></span>


            
            </td>

            

            

            <td class="description last">An option function that is
called when a duplicate is found.  If the resource is not found and this
function is defined, the resource is rejected with the result of this
function.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line293">line 293</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is resolved if the resource is
unique (that is, if no records are found).  If the resource is not
unique then the promise is rejected with a DuplicateError instance.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;bool></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="replace"><span class="type-signature"></span>replace<span class="signature">(parentTableName, parentID, resources)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;Object>>}</span></h4>

    



<div class="description">
    Replace (remove and recreate) all the resources associated with a parent
table.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>parentTableName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The name of the parent table.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>parentID</code></td>
            

            <td class="type">
            
                
<span class="param-type">any</span>


            
            </td>

            

            

            <td class="description last">The identifier of the parent resource.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>resources</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">An array of resources which will be
created.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line380">line 380</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    The array of resources, each updated with
their new identifier and parentID.  The parent and the resources are
validated, so the returned promise shall be rejected if a validation
error occurs.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;Object>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="retrieve"><span class="type-signature"></span>retrieve<span class="signature">(where, params)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;Object>>}</span></h4>

    



<div class="description">
    Retrieve an array of resources.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>where</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An optional where condition.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Query parameters for the where condition.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line254">line 254</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is resolved with the results
as an array.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;Object>></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="retrieveByID"><span class="type-signature"></span>retrieveByID<span class="signature">(id)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Retrieve a single resource by ID.  Specialized version of retrieveSingle.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">any</span>


            
            </td>

            

            

            <td class="description last">The unique identifier of the resource.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line276">line 276</a>
    </li></ul></dd>
    

    

    

    
</dl>
















        
            

    

    <h4 class="name" id="retrieveSingle"><span class="type-signature"></span>retrieveSingle<span class="signature">(where, params, onNotFound)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Retrieve a single resource as an object.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>where</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An optional where condition.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Query parameters for the where condition.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onNotFound</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="GenericDao.html#~errorCallback">GenericDao~errorCallback</a></span>


            
            </td>

            

            

            <td class="description last">An optional function that
produces an Error when a resource is not found.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line268">line 268</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is resolved with the first
matching resource.  If there are no matches found, then the promise is
rejected with a NotFoundError instance.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="update"><span class="type-signature"></span>update<span class="signature">(resource)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Generic update method that validates a model using an UpdateValidator
and then updates it by ID.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A model to update by ID.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line350">line 350</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    Same as updateIf.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="updateIf"><span class="type-signature"></span>updateIf<span class="signature">(resource, condition)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    



<div class="description">
    Update a resource if a condition resolves successfully.  Note
that prior to invoking the condition the resource is validated
using an UpdateValidator.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A model to update by ID.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>condition</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="GenericDao.html#~conditionCallback">GenericDao~conditionCallback</a></span>


            
            </td>

            

            

            <td class="description last">A function that
returns a promise.  If the promise is resolved then the model is
created.  resource is passed to condition.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line340">line 340</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is:
1) Resolved with the model if the model is valid and the
   condition is resolved.
2) Rejected with a ValidationErrorList if the model is invalid.
3) Rejected with condition's promise if condition is rejected.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    



        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                

    

    <h4 class="name" id="~conditionCallback"><span class="type-signature"></span>conditionCallback<span class="signature">(resource)</span><span class="type-signature"> &rarr; {Promise.&lt;bool>}</span></h4>

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>resource</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">The resource object.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line240">line 240</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that is resolved if the condition is
met, or otherwise rejected.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;bool></span>


    </dd>
</dl>

    



            
                

    

    <h4 class="name" id="~errorCallback"><span class="type-signature"></span>errorCallback<span class="signature">(err)</span><span class="type-signature"> &rarr; {Error}</span></h4>

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>err</code></td>
            

            <td class="type">
            
                
<span class="param-type">Error</span>


            
            </td>

            

            

            <td class="description last">An Error instance.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="GenericDao.js.html">GenericDao.js</a>, <a href="GenericDao.js.html#line233">line 233</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    A promise that produces a customized Error
instance.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Error</span>


    </dd>
</dl>

    



            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GenericDao.html">GenericDao</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Sat Feb 11 2017 10:18:55 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>