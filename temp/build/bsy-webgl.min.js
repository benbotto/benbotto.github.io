"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _get=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e){e.bsy=e.bsy||{}}(window),function(e){var t=function(){function e(){_classCallCheck(this,e),this.location=vec3.fromValues(0,0,0),this.view=mat4.lookAt(mat4.create(),this.location,vec3.fromValues(0,0,-1),vec3.fromValues(0,1,0))}return _createClass(e,[{key:"getView",value:function(){return this.view}},{key:"setView",value:function(e){return this.view=e,this}},{key:"getLocation",value:function(){return this.location}}]),e}();e.Camera=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.U=vec3.fromValues(1,0,0),e.V=vec3.fromValues(0,1,0),e.N=vec3.fromValues(0,0,-1),e}return _inherits(r,e.Camera),_createClass(r,[{key:"_updateView",value:function(){var e=vec3.normalize(vec3.create(),this.N),t=vec3.scaleAndAdd(vec3.create(),this.location,e,2);this.setView(mat4.lookAt(mat4.create(),this.location,t,this.V))}},{key:"moveForward",value:function(e){var t=vec3.normalize(vec3.create(),this.N);this.location=vec3.scaleAndAdd(vec3.create(),this.location,t,e),this._updateView()}},{key:"moveBackward",value:function(e){this.moveForward(-e)}},{key:"strafeRight",value:function(e){var t=vec3.normalize(vec3.create(),this.U);this.location=vec3.scaleAndAdd(vec3.create(),this.location,t,e),this._updateView()}},{key:"strafeLeft",value:function(e){this.strafeRight(-e)}},{key:"pitch",value:function(e){var t=quat.setAxisAngle(quat.create(),this.U,e);vec3.transformQuat(this.V,this.V,t),vec3.transformQuat(this.N,this.N,t),this._updateView()}},{key:"pitchUp",value:function(e){this.pitch(e)}},{key:"pitchDown",value:function(e){this.pitch(-e)}},{key:"yaw",value:function(e){var t=quat.setAxisAngle(quat.create(),this.V,e);vec3.transformQuat(this.U,this.U,t),vec3.transformQuat(this.N,this.N,t),this._updateView()}},{key:"yawLeft",value:function(e){this.yaw(e)}},{key:"yawRight",value:function(e){this.yaw(-e)}}]),r}();e.SixDoFCamera=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"fillNewBuffer",value:function(e,t){var r=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),r}}]),e}();e.BufferMgr=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"compile",value:function(e,t){for(var r=e.createShader(t),n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var a=i.reduce(function(e,t){return e+="\n"+t},"");if(e.shaderSource(r,a),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(r);throw e.deleteShader(r),new Error("An error occurred compiling the shader: "+s)}return r}}]),e}();e.Compiler=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"link",value:function(e){for(var t=e.createProgram(),r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(n.forEach(function(r){return e.attachShader(t,r)}),e.linkProgram(t),!e.getProgramParameter(t,e.LINK_STATUS))throw new Error("Unable to initialize the shader program: "+e.getProgramInfoLog(t));return t}}]),e}();e.Linker=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"loadImage",value:function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=function(){return r(new Error("Failed to load image from "+e+"."))},n.src=e})}},{key:"loadTexture",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r&&this.isPowerOf2(t)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),n}},{key:"isPowerOf2",value:function(e){return 0==(e.width&e.width-1)&&0==(e.height&e.height-1)}}]),e}();e.TextureMgr=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getAmbient",value:function(){throw new Error("getAmbient() not implemented.")}},{key:"getDiffuse",value:function(){throw new Error("getDiffuse() not implemented.")}},{key:"getSpecular",value:function(){throw new Error("getSpecular() not implemented.")}},{key:"getShininess",value:function(){throw new Error("getShininess() not implemented.")}}]),e}();e.Material=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.ambient=vec4.fromValues(.1,.2,.4,1),e.diffuse=vec4.fromValues(.08,.15,.9,1),e.specular=vec4.fromValues(.15,.3,.97,1),e.shininess=97.9,e}return _inherits(r,e.Material),_createClass(r,[{key:"getAmbient",value:function(){return this.ambient}},{key:"getDiffuse",value:function(){return this.diffuse}},{key:"getSpecular",value:function(){return this.specular}},{key:"getShininess",value:function(){return this.shininess}}]),r}();e.BluePlastic=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.ambient=vec4.fromValues(.3294,.2235,.02745,1),e.diffuse=vec4.fromValues(.7804,.5686,.1137,1),e.specular=vec4.fromValues(.9922,.9412,.8078,1),e.shininess=27.9,e}return _inherits(r,e.Material),_createClass(r,[{key:"getAmbient",value:function(){return this.ambient}},{key:"getDiffuse",value:function(){return this.diffuse}},{key:"getSpecular",value:function(){return this.specular}},{key:"getShininess",value:function(){return this.shininess}}]),r}();e.Brass=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.ambient=vec4.fromValues(.09,.06,.05,1),e.diffuse=vec4.fromValues(.09,.06,.05,1),e.specular=vec4.fromValues(.15,.1,.05,1),e.shininess=.9,e}return _inherits(r,e.Material),_createClass(r,[{key:"getAmbient",value:function(){return this.ambient}},{key:"getDiffuse",value:function(){return this.diffuse}},{key:"getSpecular",value:function(){return this.specular}},{key:"getShininess",value:function(){return this.shininess}}]),r}();e.Wood=t}(window.bsy),function(e){var t=function(){function e(t,r,n){_classCallCheck(this,e),this.gl=t,this.worldObj=r,this.program=n,this.renderers=[],this.projection=mat4.create(),this.view=mat4.create(),this.model=mat4.create()}return _createClass(e,[{key:"render",value:function(e,t,r){var n=mat4.multiply(mat4.create(),r,this.getWorldObject().getTransform());this.getRenderers().forEach(function(r){return r.render(e,t,n)})}},{key:"getProjectionLoc",value:function(){throw new Error("getProjectionLoc() not implemented.")}},{key:"getViewLoc",value:function(){throw new Error("getViewLoc() not implemented.")}},{key:"getModelLoc",value:function(){throw new Error("getModelLoc() not implemented.")}},{key:"writeProjection",value:function(){this.getContext().uniformMatrix4fv(this.getProjectionLoc(),!1,this.getProjection())}},{key:"writeView",value:function(){this.getContext().uniformMatrix4fv(this.getViewLoc(),!1,this.getView())}},{key:"writeModel",value:function(){this.getContext().uniformMatrix4fv(this.getModelLoc(),!1,this.getModel())}},{key:"getWorldObject",value:function(){return this.worldObj}},{key:"getContext",value:function(){return this.gl}},{key:"getProgram",value:function(){return this.program}},{key:"useProgram",value:function(){this.getContext().useProgram(this.getProgram())}},{key:"addRenderer",value:function(e){return this.renderers.push(e),e.setProjection(this.projection),e.setView(this.view),this}},{key:"getRenderers",value:function(){return this.renderers}},{key:"setProjection",value:function(e){return this.projection=e,this.renderers.forEach(function(t){return t.setProjection(e)}),this}},{key:"getProjection",value:function(){return this.projection}},{key:"setView",value:function(e){return this.view=e,this.renderers.forEach(function(t){return t.setView(e)}),this}},{key:"getView",value:function(){return this.view}},{key:"setModel",value:function(e){return this.model=e,this}},{key:"getModel",value:function(){return this.model}}]),e}();e.Renderer=t}(window.bsy),function(e){var t=function(t){function r(e,t,n){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t,n));return i.ambientLoc=e.getUniformLocation(n,"uDistLight.ambient"),i.diffuseLoc=e.getUniformLocation(n,"uDistLight.diffuse"),i.specularLoc=e.getUniformLocation(n,"uDistLight.specular"),i.directionLoc=e.getUniformLocation(n,"uDistLight.direction"),i}return _inherits(r,e.Renderer),_createClass(r,[{key:"render",value:function(){var e=this.getWorldObject();this.useProgram(),this.getContext().uniform4fv(this.ambientLoc,e.getAmbient()),this.getContext().uniform4fv(this.diffuseLoc,e.getDiffuse()),this.getContext().uniform4fv(this.specularLoc,e.getSpecular()),this.getContext().uniform3fv(this.directionLoc,e.getDirection())}}]),r}();e.ADSDistanceLightRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new e.BufferMgr,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new e.TextureMgr;_classCallCheck(this,r);var c=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return c.textureUnit=void 0===o?t.TEXTURE0:o,c.vertBuffer=a.fillNewBuffer(t,n.getVertices()),c.vertNormBuffer=a.fillNewBuffer(t,n.getVertexNormals()),c.texelBuffer=a.fillNewBuffer(t,n.getTextureCoords()),c.texture=s.loadTexture(t,n.getTextureImage()),c.modelLoc=t.getUniformLocation(i,"uModelMatrix"),c.viewLoc=t.getUniformLocation(i,"uViewMatrix"),c.projectionLoc=t.getUniformLocation(i,"uProjectionMatrix"),c.normalTransLoc=t.getUniformLocation(i,"uNormalTrans"),c.samplerLoc=t.getUniformLocation(i,"uSampler"),c.vertexLoc=t.getAttribLocation(i,"aVertexPosition"),c.vertexNormLoc=t.getAttribLocation(i,"aVertexNormal"),c.texelLoc=t.getAttribLocation(i,"aTextureCoord"),c.matAmbientLoc=t.getUniformLocation(i,"uMaterial.ambient"),c.matDiffuseLoc=t.getUniformLocation(i,"uMaterial.diffuse"),c.matSpecularLoc=t.getUniformLocation(i,"uMaterial.specular"),c.matShininessLoc=t.getUniformLocation(i,"uMaterial.shininess"),c}return _inherits(r,e.Renderer),_createClass(r,[{key:"getProjectionLoc",value:function(){return this.projectionLoc}},{key:"getViewLoc",value:function(){return this.viewLoc}},{key:"getModelLoc",value:function(){return this.modelLoc}},{key:"writeMaterial",value:function(){var e=this.getWorldObject().getMaterial();this.getContext().uniform4fv(this.matAmbientLoc,e.getAmbient()),this.getContext().uniform4fv(this.matDiffuseLoc,e.getDiffuse()),this.getContext().uniform4fv(this.matSpecularLoc,e.getSpecular()),this.getContext().uniform1f(this.matShininessLoc,e.getShininess())}},{key:"getNormalTransLoc",value:function(){return this.normalTransLoc}},{key:"writeNormalTrans",value:function(){var e=mat4.create();mat4.transpose(e,mat4.invert(e,mat4.multiply(e,this.getView(),this.getModel()))),this.getContext().uniformMatrix4fv(this.getNormalTransLoc(),!1,e)}},{key:"render",value:function(e,t,r){this.useProgram(),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuffer),e.vertexAttribPointer(this.vertexLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexLoc),e.bindBuffer(e.ARRAY_BUFFER,this.vertNormBuffer),e.vertexAttribPointer(this.vertexNormLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexNormLoc),e.bindBuffer(e.ARRAY_BUFFER,this.texelBuffer),e.vertexAttribPointer(this.texelLoc,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.texelLoc),e.activeTexture(this.textureUnit),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(this.samplerLoc,0);var n=mat4.create();mat4.multiply(n,r,this.getWorldObject().getTransform()),this.setModel(n),this.writeProjection(),this.writeView(),this.writeModel(),this.writeMaterial(),this.writeNormalTrans(n),e.drawArrays(e.TRIANGLES,0,this.getWorldObject().getVertices().length/3),e.disableVertexAttribArray(this.vertexLoc),e.disableVertexAttribArray(this.vertexNormLoc),e.disableVertexAttribArray(this.texelLoc)}}]),r}();e.ADSTextureWorldObjectRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e.BufferMgr;_classCallCheck(this,r);var a=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return a.vertBuffer=o.fillNewBuffer(t,n.getVertices()),a.vertNormBuffer=o.fillNewBuffer(t,n.getVertexNormals()),a.modelLoc=t.getUniformLocation(i,"uModelMatrix"),a.viewLoc=t.getUniformLocation(i,"uViewMatrix"),a.projectionLoc=t.getUniformLocation(i,"uProjectionMatrix"),a.normalTransLoc=t.getUniformLocation(i,"uNormalTrans"),a.vertexLoc=t.getAttribLocation(i,"aVertexPosition"),a.vertexNormLoc=t.getAttribLocation(i,"aVertexNormal"),a.matAmbientLoc=t.getUniformLocation(i,"uMaterial.ambient"),a.matDiffuseLoc=t.getUniformLocation(i,"uMaterial.diffuse"),a.matSpecularLoc=t.getUniformLocation(i,"uMaterial.specular"),a.matShininessLoc=t.getUniformLocation(i,"uMaterial.shininess"),a}return _inherits(r,e.Renderer),_createClass(r,[{key:"getProjectionLoc",value:function(){return this.projectionLoc}},{key:"getViewLoc",value:function(){return this.viewLoc}},{key:"getModelLoc",value:function(){return this.modelLoc}},{key:"writeMaterial",value:function(){var e=this.getWorldObject().getMaterial();this.getContext().uniform4fv(this.matAmbientLoc,e.getAmbient()),this.getContext().uniform4fv(this.matDiffuseLoc,e.getDiffuse()),this.getContext().uniform4fv(this.matSpecularLoc,e.getSpecular()),this.getContext().uniform1f(this.matShininessLoc,e.getShininess())}},{key:"getNormalTransLoc",value:function(){return this.normalTransLoc}},{key:"writeNormalTrans",value:function(){var e=mat4.create();mat4.transpose(e,mat4.invert(e,mat4.multiply(e,this.getView(),this.getModel()))),this.getContext().uniformMatrix4fv(this.getNormalTransLoc(),!1,e)}},{key:"render",value:function(e,t,r){this.useProgram(),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuffer),e.vertexAttribPointer(this.vertexLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexLoc),e.bindBuffer(e.ARRAY_BUFFER,this.vertNormBuffer),e.vertexAttribPointer(this.vertexNormLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexNormLoc);var n=mat4.create();mat4.multiply(n,r,this.getWorldObject().getTransform()),this.setModel(n),this.writeProjection(),this.writeView(),this.writeModel(),this.writeMaterial(),this.writeNormalTrans(n),e.drawArrays(e.TRIANGLES,0,this.getWorldObject().getVertices().length/3),e.disableVertexAttribArray(this.vertexLoc),e.disableVertexAttribArray(this.vertexNormLoc)}}]),r}();e.ADSWorldObjectRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){_classCallCheck(this,r);var o=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return o.addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("up"),i)).addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("down"),i)).addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("right"),i)).addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("left"),i)).addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("front"),i)).addRenderer(new e.IdentityWorldObjectRenderer(t,n.getWorldObject("back"),i)),o}return _inherits(r,e.Renderer),r}();e.ColorCubeRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){_classCallCheck(this,r);var o=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return o.addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("up"),i,t.TEXTURE0,o.useMipMaps())).addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("down"),i,t.TEXTURE1,o.useMipMaps())).addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("right"),i,t.TEXTURE2,o.useMipMaps())).addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("left"),i,t.TEXTURE3,o.useMipMaps())).addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("front"),i,t.TEXTURE4,o.useMipMaps())).addRenderer(new e.IdentityTextureWorldObjectRenderer(t,n.getWorldObject("back"),i,t.TEXTURE5,o.useMipMaps())),o}return _inherits(r,e.Renderer),_createClass(r,[{key:"useMipMaps",value:function(){return!0}}]),r}();e.IdentityTextureCubeRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i,o){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new e.BufferMgr,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new e.TextureMgr;_classCallCheck(this,r);var u=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return u.textureUnit=void 0===o?t.TEXTURE0:o,u.vertBuffer=s.fillNewBuffer(t,n.getVertices()),u.texelBuffer=s.fillNewBuffer(t,n.getTextureCoords()),u.texture=c.loadTexture(t,n.getTextureImage(),a),u.modelLoc=t.getUniformLocation(i,"uModelMatrix"),u.viewLoc=t.getUniformLocation(i,"uViewMatrix"),u.projectionLoc=t.getUniformLocation(i,"uProjectionMatrix"),u.samplerLoc=t.getUniformLocation(i,"uSampler"),u.vertexLoc=t.getAttribLocation(i,"aVertexPosition"),u.texelLoc=t.getAttribLocation(i,"aTextureCoord"),u}return _inherits(r,e.Renderer),_createClass(r,[{key:"getProjectionLoc",value:function(){return this.projectionLoc}},{key:"getViewLoc",value:function(){return this.viewLoc}},{key:"getModelLoc",value:function(){return this.modelLoc}},{key:"render",value:function(e,t,r){this.useProgram(),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuffer),e.vertexAttribPointer(this.vertexLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexLoc),e.bindBuffer(e.ARRAY_BUFFER,this.texelBuffer),e.vertexAttribPointer(this.texelLoc,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.texelLoc),e.activeTexture(this.textureUnit),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(this.samplerLoc,this.textureUnit-e.TEXTURE0);var n=mat4.create();mat4.multiply(n,r,this.getWorldObject().getTransform()),this.setModel(n),this.writeProjection(),this.writeView(),this.writeModel(),e.drawArrays(e.TRIANGLES,0,this.getWorldObject().getVertices().length/3),e.disableVertexAttribArray(this.vertexLoc),e.disableVertexAttribArray(this.texelLoc)}}]),r}();e.IdentityTextureWorldObjectRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e.BufferMgr;_classCallCheck(this,r);var a=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return a.vertBuffer=o.fillNewBuffer(t,n.getVertices()),a.colorBuffer=o.fillNewBuffer(t,n.getVertexColors()),a.modelLoc=t.getUniformLocation(i,"uModelMatrix"),a.viewLoc=t.getUniformLocation(i,"uViewMatrix"),a.projectionLoc=t.getUniformLocation(i,"uProjectionMatrix"),a.vertexLoc=t.getAttribLocation(i,"aVertexPosition"),a.colorLoc=t.getAttribLocation(i,"aVertexColor"),a}return _inherits(r,e.Renderer),_createClass(r,[{key:"getProjectionLoc",value:function(){return this.projectionLoc}},{key:"getViewLoc",value:function(){return this.viewLoc}},{key:"getModelLoc",value:function(){return this.modelLoc}},{key:"render",value:function(e,t,r){this.useProgram(),e.bindBuffer(e.ARRAY_BUFFER,this.vertBuffer),e.vertexAttribPointer(this.vertexLoc,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.vertexLoc),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.vertexAttribPointer(this.colorLoc,4,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.colorLoc);var n=mat4.create();mat4.multiply(n,r,this.getWorldObject().getTransform()),this.setModel(n),this.writeProjection(),this.writeView(),this.writeModel(),e.drawArrays(e.TRIANGLES,0,this.getWorldObject().getVertices().length/3),e.disableVertexAttribArray(this.vertexLoc),e.disableVertexAttribArray(this.colorLoc)}}]),r}();e.IdentityWorldObjectRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){_classCallCheck(this,r);var o=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return o.addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("up"),i)).addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("down"),i)).addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("right"),i)).addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("left"),i)).addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("front"),i)).addRenderer(new e.ADSWorldObjectRenderer(t,n.getWorldObject("back"),i)),o}return _inherits(r,e.Renderer),r}();e.MaterialCubeRenderer=t}(window.bsy),function(e){var t=function(t){function r(t,n,i){_classCallCheck(this,r);var o=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,n,i));return o.addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("up"),i)).addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("down"),i)).addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("right"),i)).addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("left"),i)).addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("front"),i)).addRenderer(new e.ADSTextureWorldObjectRenderer(t,n.getWorldObject("back"),i)),o}return _inherits(r,e.Renderer),r}();e.TextureMaterialCubeRenderer=t}(window.bsy),function(e){var t=function(t){function r(e,t,n){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t,n))}return _inherits(r,e.IdentityTextureCubeRenderer),_createClass(r,[{key:"useMipMaps",value:function(){return!1}},{key:"render",value:function(e,t,n){e.disable(e.DEPTH_TEST),e.depthMask(!1),_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"render",this).call(this,e,t,n),e.enable(e.DEPTH_TEST),e.depthMask(!0)}}]),r}();e.SkyBoxRenderer=t}(window.bsy),function(e){var t=function(t){function r(e,t,n){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t,n));return i.transform=mat4.create(),i.fov=35*Math.PI/180,i.zNear=.1,i.zFar=1e3,i.aspect=null,i.updateViewSize(),i.setView(i.getWorldObject().getCamera().getView()),e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),i}return _inherits(r,e.Renderer),_createClass(r,[{key:"getTransform",value:function(){return this.transform}},{key:"setTransform",value:function(e){return this.transform=e,this}},{key:"updateViewSize",value:function(){var e=mat4.create(),t=this.getContext();this.aspect=t.canvas.clientWidth/t.canvas.clientHeight,mat4.perspective(e,this.fov,this.aspect,this.zNear,this.zFar),this.setProjection(e)}},{key:"clear",value:function(){var e=this.getContext();e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},{key:"render",value:function(e,t){var r=this;this.clear(),this.useProgram(),this.setView(this.getWorldObject().getCamera().getView()),this.renderers.forEach(function(n){return n.render(e,t,r.getTransform())})}}]),r}();e.WorldRenderer=t}(window.bsy),window.bsy.DistanceLightH="\n    precision mediump float;\n\n    /**\n     * Representation of a distance light.\n     */\n    struct DistanceLight\n    {\n      vec4 ambient;\n      vec4 diffuse;\n      vec4 specular;\n      vec3 direction;\n    };\n\n    /**\n     * Calculate the intensity of the DistanceLight using the Material m.\n     * @param m The Material.\n     *\n     * @param L The vector from the vertex to the light.\n     * @param N The vertex normal.\n     * @param V The vector from the vertex to the eye.\n     *\n     * @param ambient The ambient light of the light.\n     * @param diffuse The diffuse light of the light.\n     * @param specular The specular light of the light.\n     */\n    vec4 getIntensity(Material m, vec3 L, vec3 N, vec3 V,\n      vec4 ambient, vec4 diffuse, vec4 specular)\n    {\n      /*   \n       *   L  N  R\n       *     | /\n       *     |/___V  (eye)\n       */\n      float cosLN, cosVR;\n      vec4  intensity;\n      vec3  R;\n\n      // Reflect the light off the normal.\n      R = normalize(reflect(-L, N));\n\n      // The angle between the light and the surface normal.\n      cosLN = dot(L, N);\n\n      // The angle between the vector to the eye and the reflected light.\n      cosVR = dot(V, R);\n\n      intensity = \n        ambient  * m.ambient  +\n        diffuse  * m.diffuse  * max(cosLN,     0.0)  +\n        specular * m.specular * pow(max(cosVR, 0.0), m.shininess);\n\n      return intensity;\n    }\n\n    /**\n     * Same as above but accepts a DistanceLight.\n     * @param l The DistanceLight.\n     * @param m The Material.\n     * @param L The vector from the vertex to the light.\n     * @param N The vertex normal.\n     * @param V The vector from the vertex to the eye.\n     */\n    vec4 getIntensity(DistanceLight l, Material m, vec3 L, vec3 N, vec3 V)\n    {\n      return getIntensity(m, L, N, V, l.ambient, l.diffuse, l.specular);\n    }\n  ",window.bsy.MaterialH="\n    precision mediump float;\n\n    struct Material\n    {\n      vec4  ambient;\n      vec4  diffuse;\n      vec4  specular;\n      float shininess;\n    };\n  ",window.bsy.adsFrag="\n    uniform Material      uMaterial;\n    uniform DistanceLight uDistLight;\n\n    // Vertex normal converted to eye space.\n    varying vec3 oNormalEC;\n\n    // The vector from vertex to the light, converted to eye space.\n    varying vec3 oVertToDistLight;\n\n    // The vertex position, which will be moved to eye coords.\n    varying vec3 oVertPosEC;\n\n    void main() {\n      vec3 L, N, V;\n\n      // The vertex normal.\n      N = normalize(oNormalEC);\n\n      // The vector from the vertex to the eye.\n      V = normalize(-oVertPosEC);\n\n      // Vertex to the light.\n      L = normalize(oVertToDistLight);\n\n      // Distance light intensity.\n      gl_FragColor = getIntensity(uDistLight, uMaterial, L, N, V);\n    }\n  ",window.bsy.adsTextureFrag="\n    uniform Material      uMaterial;\n    uniform DistanceLight uDistLight;\n    uniform sampler2D     uSampler;\n\n    // Vertex normal converted to eye space.\n    varying vec3 oNormalEC;\n\n    // The vector from vertex to the light, converted to eye space.\n    varying vec3 oVertToDistLight;\n\n    // The vertex position, which will be moved to eye coords.\n    varying vec3 oVertPosEC;\n\n    // Texture coord from vertex shader.\n    varying highp vec2 vTextureCoord;\n\n    void main() {\n      vec3 L, N, V;\n\n      // The vertex normal.\n      N = normalize(oNormalEC);\n\n      // The vector from the vertex to the eye.\n      V = normalize(-oVertPosEC);\n\n      // Vertex to the light.\n      L = normalize(oVertToDistLight);\n\n      // Distance light intensity with texture.  The texture color mostly\n      // replaces the material's diffuse part and partly replaces the\n      // material's ambient part.\n      Material holdMat = uMaterial;\n      vec4     texClr  = texture2D(uSampler, vTextureCoord);\n      holdMat.diffuse  = mix(uMaterial.diffuse, texClr, .85);\n      holdMat.ambient  = mix(uMaterial.ambient, texClr, .25);\n      gl_FragColor     = getIntensity(uDistLight, holdMat, L, N, V);\n    }\n  ",window.bsy.adsTextureVert="\n    attribute vec3 aVertexPosition;\n    attribute vec3 aVertexNormal;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uModelMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    uniform mat4 uNormalTrans;\n\n    uniform DistanceLight uDistLight;\n\n    // Vertex normal converted to eye space.\n    varying vec3 oNormalEC;\n\n    // The vector from vertex to the light, converted to eye space.\n    varying vec3 oVertToDistLight;\n\n    // The vertex position, which will be moved to eye coords.\n    varying vec3 oVertPosEC;\n\n    // Texture coord, passed to frag shader.\n    varying highp vec2 vTextureCoord;\n\n    void main() {\n      mat4 modelView = uViewMatrix * uModelMatrix;\n\n      // Convert the vertex position to eye space.\n      vec4 vertPosEC = modelView * vec4(aVertexPosition, 1);\n\n      // Pass the vertex position down the pipeline.\n      oVertPosEC = vertPosEC.xyz;\n\n      // With a distance light the vector from the vertex to the light\n      // is always the same - the opposite of the distance light's direction -\n      // and the distance light is very far away.\n      vec4 distLightPosEC = uViewMatrix * vec4(-uDistLight.direction * 1000.0, 1);\n      oVertToDistLight    = (distLightPosEC - vertPosEC).xyz;\n\n      // Move the normal to eye space and pass it down.\n      oNormalEC = (uNormalTrans * vec4(aVertexNormal, 0)).xyz;\n\n      gl_Position   = uProjectionMatrix * vertPosEC;\n      vTextureCoord = aTextureCoord;\n    }\n  ",window.bsy.adsVert="\n    attribute vec3 aVertexPosition;\n    attribute vec3 aVertexNormal;\n\n    uniform mat4 uModelMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    uniform mat4 uNormalTrans;\n\n    uniform DistanceLight uDistLight;\n\n    // Vertex normal converted to eye space.\n    varying vec3 oNormalEC;\n\n    // The vector from vertex to the light, converted to eye space.\n    varying vec3 oVertToDistLight;\n\n    // The vertex position, which will be moved to eye coords.\n    varying vec3 oVertPosEC;\n\n    void main() {\n      mat4 modelView = uViewMatrix * uModelMatrix;\n\n      // Convert the vertex position to eye space.\n      vec4 vertPosEC = modelView * vec4(aVertexPosition, 1);\n\n      // Pass the vertex position down the pipeline.\n      oVertPosEC = vertPosEC.xyz;\n\n      // With a distance light the vector from the vertex to the light\n      // is always the same - the opposite of the distance light's direction -\n      // and the distance light is very far away.\n      vec4 distLightPosEC = uViewMatrix * vec4(-uDistLight.direction * 1000.0, 1);\n      oVertToDistLight    = (distLightPosEC - vertPosEC).xyz;\n\n      // Move the normal to eye space and pass it down.\n      oNormalEC = (uNormalTrans * vec4(aVertexNormal, 0)).xyz;\n\n      gl_Position = uProjectionMatrix * vertPosEC;\n    }\n  ",window.bsy.identityFrag="\n    varying lowp vec4 color;\n\n    void main() {\n      gl_FragColor = color;\n    }\n  ",window.bsy.identityTextureFrag="\n    uniform sampler2D uSampler;\n\n    varying highp vec2 vTextureCoord;\n\n    void main() {\n      gl_FragColor = texture2D(uSampler, vTextureCoord);\n    }\n  ",window.bsy.identityTextureVert="\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uModelMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    varying highp vec2 vTextureCoord;\n\n    void main() {\n      gl_Position   = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n      vTextureCoord = aTextureCoord;\n    }\n  ",window.bsy.identityVert="\n    attribute vec3 aVertexPosition;\n    attribute vec4 aVertexColor;\n\n    uniform mat4 uModelMatrix;\n    uniform mat4 uViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    varying lowp vec4 color;\n\n    void main() {\n      gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n      color       = aVertexColor;\n    }\n  ",function(e){var t=function(){function e(t,r){var n=this;_classCallCheck(this,e),this.canvas=window.document.createElement("canvas"),this.canvas.width=t||window.innerWidth,this.canvas.height=r||window.innerHeight,this.gl=this.canvas.getContext("webgl"),this.onDraw=function(){},this.autoresize=!t&&!r,this.onresize=function(){},this.startTime=null,this.lastTime=null,window.document.body.appendChild(this.canvas),window.onresize=function(e){n.autoresize&&(n.canvas.width=window.innerWidth,n.canvas.height=window.innerHeight,n.getContext().viewport(0,0,n.canvas.width,n.canvas.height)),n.onresize(e)}}return _createClass(e,[{key:"getContext",value:function(){return this.gl}},{key:"start",value:function(){function e(){var r=new Date,n=r.getTime()-t.lastTime.getTime();t.lastTime=r,t.onDraw(t.gl,n),window.requestAnimationFrame(e)}var t=this;this.startTime=new Date,this.lastTime=new Date,window.requestAnimationFrame(e)}}]),e}();e.Easel=t}(window.bsy),function(e){var t=function(){function e(){var t=this;_classCallCheck(this,e),this._keyState=new Set,window.onkeydown=function(e){t.isKeyDown(e.code)||t._keyState.add(e.code)},window.onkeyup=function(e){return t._keyState.delete(e.code)}}return _createClass(e,[{key:"isKeyDown",value:function(e){return this._keyState.has(e)}}]),e}();e.KeyMgr=t}(window.bsy),function(e){var t=function(){function e(t){var r=this;_classCallCheck(this,e),this.canvas=t,this.enablePointerLock=!0,this._pointerLocked=!1,this.onmousemove=function(){},window.document.onpointerlockchange=function(e){return r._onpointerlockchange(e)},this.canvas.onclick=function(){return r._lockPointer()},this.canvas.onmousemove=function(e){return r._onmousemove(e)}}return _createClass(e,[{key:"_lockPointer",value:function(){this.enablePointerLock&&this.canvas.requestPointerLock()}},{key:"isPointerLocked",value:function(){return this._pointerLocked}},{key:"_onmousemove",value:function(e){this.onmousemove({pointerLocked:this.isPointerLocked(),clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY})}},{key:"_onpointerlockchange",value:function(){this._pointerLocked=window.document.pointerLockElement===this.canvas}}]),e}();e.MouseMgr=t}(window.bsy),function(e){var t=function(){function e(){_classCallCheck(this,e),this.worldObjects=new Map,this.transform=mat4.create()}return _createClass(e,[{key:"getVertices",value:function(){throw new Error("getVertices() not implemented.")}},{key:"getVertexColors",value:function(){throw new Error("getVertexColors() not implemented.")}},{key:"getVertexNormals",value:function(){throw new Error("getVertexNormals() not implemented.")}},{key:"getMaterial",value:function(){throw new Error("getMaterial() not implemented.")}},{key:"getTextureCoords",value:function(){throw new Error("getTextureCoords() not implemented.")}},{key:"getTextureImage",value:function(){throw new Error("getTextureImage() not implemented.")}},{key:"addWorldObject",value:function(e,t){if(this.worldObjects.has(e))throw new Error("World object "+e+" already exists.");return this.worldObjects.set(e,t),this}},{key:"getWorldObject",value:function(e){return this.worldObjects.get(e)}},{key:Symbol.iterator,value:regeneratorRuntime.mark(function e(){var t,r,n,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,r=!1,n=void 0,e.prev=3,i=this.worldObjects.values()[Symbol.iterator]();case 5:if(t=(o=i.next()).done){e.next=12;break}return a=o.value,e.next=9,a;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),r=!0,n=e.t0;case 18:e.prev=18,e.prev=19,!t&&i.return&&i.return();case 21:if(e.prev=21,!r){e.next=24;break}throw n;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"getTransform",value:function(){return this.transform}},{key:"setTransform",value:function(e){return this.transform=e,this}}]),e}();e.WorldObject=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));e._createCubeFaces();var t=e.getWorldObject("up"),n=e.getWorldObject("down"),i=e.getWorldObject("right"),o=e.getWorldObject("left"),a=e.getWorldObject("front"),s=e.getWorldObject("back"),c=void 0;return c=t.getTransform(),mat4.translate(c,c,[0,.5,0]),mat4.rotate(c,c,-Math.PI/2,[1,0,0]),c=n.getTransform(),mat4.translate(c,c,[0,-.5,0]),mat4.rotate(c,c,Math.PI/2,[1,0,0]),c=i.getTransform(),mat4.translate(c,c,[.5,0,0]),mat4.rotate(c,c,Math.PI/2,[0,1,0]),c=o.getTransform(),mat4.translate(c,c,[-.5,0,0]),mat4.rotate(c,c,-Math.PI/2,[0,1,0]),c=a.getTransform(),mat4.translate(c,c,[0,0,.5]),c=s.getTransform(),mat4.translate(c,c,[0,0,-.5]),mat4.rotate(c,c,Math.PI,[0,1,0]),e}return _inherits(r,e.WorldObject),_createClass(r,[{key:"_createCubeFaces",value:function(){throw new Error("_createCubeFaces() not implemented.")}}]),r}();e.Cube=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(e){if(6!==e.length)throw new Error("6 colors are required.")}else e=Array.from({length:6},function(){return[1,1,1,1]});return t.getWorldObject("up").setColor(e[0]),t.getWorldObject("down").setColor(e[1]),t.getWorldObject("right").setColor(e[2]),t.getWorldObject("left").setColor(e[3]),t.getWorldObject("front").setColor(e[4]),t.getWorldObject("back").setColor(e[5]),t}return _inherits(r,e.Cube),_createClass(r,[{key:"_createCubeFaces",value:function(){this.addWorldObject("up",new e.ColorSquare),this.addWorldObject("down",new e.ColorSquare),this.addWorldObject("right",new e.ColorSquare),this.addWorldObject("left",new e.ColorSquare),this.addWorldObject("front",new e.ColorSquare),this.addWorldObject("back",new e.ColorSquare)}}]),r}();e.ColorCube=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.setMaterial(e),t}return _inherits(r,e.Cube),_createClass(r,[{key:"_createCubeFaces",value:function(){this.addWorldObject("up",new e.MaterialSquare),this.addWorldObject("down",new e.MaterialSquare),this.addWorldObject("right",new e.MaterialSquare),this.addWorldObject("left",new e.MaterialSquare),this.addWorldObject("front",new e.MaterialSquare),this.addWorldObject("back",new e.MaterialSquare)}},{key:"setMaterial",value:function(e){this.material=e,this.getWorldObject("up").setMaterial(e),this.getWorldObject("down").setMaterial(e),this.getWorldObject("right").setMaterial(e),this.getWorldObject("left").setMaterial(e),this.getWorldObject("front").setMaterial(e),this.getWorldObject("back").setMaterial(e)}},{key:"getMaterial",value:function(){return this.material}}]),r}();e.MaterialCube=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.setTextureImage(e),t}return _inherits(r,e.Cube),_createClass(r,[{key:"_createCubeFaces",value:function(){this.addWorldObject("up",new e.TextureSquare),this.addWorldObject("down",new e.TextureSquare),this.addWorldObject("right",new e.TextureSquare),this.addWorldObject("left",new e.TextureSquare),this.addWorldObject("front",new e.TextureSquare),this.addWorldObject("back",new e.TextureSquare)}},{key:"setTextureImage",value:function(e){this.textureImage=e,this.getWorldObject("up").setTextureImage(e),this.getWorldObject("down").setTextureImage(e),this.getWorldObject("right").setTextureImage(e),this.getWorldObject("left").setTextureImage(e),this.getWorldObject("front").setTextureImage(e),this.getWorldObject("back").setTextureImage(e)}},{key:"getTextureImage",value:function(){return this.textureImage}}]),r}();e.TextureCube=t}(window.bsy),function(e){var t=function(t){function r(e,t){_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return n.setTextureImage(e),n.setMaterial(t),n}return _inherits(r,e.Cube),_createClass(r,[{key:"_createCubeFaces",value:function(){this.addWorldObject("up",new e.TextureMaterialSquare),this.addWorldObject("down",new e.TextureMaterialSquare),this.addWorldObject("right",new e.TextureMaterialSquare),this.addWorldObject("left",new e.TextureMaterialSquare),this.addWorldObject("front",new e.TextureMaterialSquare),this.addWorldObject("back",new e.TextureMaterialSquare)}},{key:"setTextureImage",value:function(e){this.textureImage=e,this.getWorldObject("up").setTextureImage(e),this.getWorldObject("down").setTextureImage(e),this.getWorldObject("right").setTextureImage(e),this.getWorldObject("left").setTextureImage(e),this.getWorldObject("front").setTextureImage(e),this.getWorldObject("back").setTextureImage(e)}},{key:"getTextureImage",value:function(){return this.textureImage}},{key:"setMaterial",value:function(e){this.material=e,this.getWorldObject("up").setMaterial(e),this.getWorldObject("down").setMaterial(e),this.getWorldObject("right").setMaterial(e),this.getWorldObject("left").setMaterial(e),this.getWorldObject("front").setMaterial(e),this.getWorldObject("back").setMaterial(e)}},{key:"getMaterial",value:function(){return this.material}}]),r}();e.TextureMaterialCube=t}(window.bsy),function(e){var t=function(){function e(t,r,n,i){_classCallCheck(this,e),this.setAmbient(t).setDiffuse(r).setSpecular(n).setDirection(i)}return _createClass(e,[{key:"getAmbient",value:function(){return this.ambient}},{key:"setAmbient",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vec4.fromValues(1,1,1,1);return this.ambient=e,this}},{key:"getDiffuse",value:function(){return this.diffuse}},{key:"setDiffuse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vec4.fromValues(1,1,1,1);return this.diffuse=e,this}},{key:"getSpecular",value:function(){return this.specular}},{key:"setSpecular",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vec4.fromValues(1,1,1,1);return this.specular=e,this}},{key:"getDirection",value:function(){return this.direction}},{key:"setDirection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vec3.fromValues(0,0,-1);return this.direction=e,this}}]),e}();e.DistanceLight=t}(window.bsy),function(e){var t=function(t){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.vertices=[-.5,.5,0,.5,.5,0,.5,-.5,0,.5,-.5,0,-.5,-.5,0,-.5,.5,0],e}return _inherits(r,e.WorldObject),_createClass(r,[{key:"getVertices",value:function(){return this.vertices}}]),r}();e.Square=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.setColor(e),t}return _inherits(r,e.Square),_createClass(r,[{key:"setColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,1,1,1];this.vertexColors=Array.from({length:6},function(){return e}).reduce(function(e,t){return t.concat(e)})}},{key:"getVertexColors",value:function(){return this.vertexColors}}]),r}();e.ColorSquare=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.material=e,t.vertexNormals=Array.from({length:6},function(){return[0,0,1]}).reduce(function(e,t){return e.concat(t)}),t}return _inherits(r,e.Square),_createClass(r,[{key:"setMaterial",value:function(e){this.material=e}},{key:"getMaterial",value:function(){return this.material}},{key:"getVertexNormals",value:function(){return this.vertexNormals}}]),r}();e.MaterialSquare=t}(window.bsy),function(e){var t=function(t){function r(t,n){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return i._texSquare=new e.TextureSquare(t),i._matSquare=new e.MaterialSquare(n),i}return _inherits(r,e.Square),_createClass(r,[{key:"setMaterial",value:function(e){this._matSquare.setMaterial(e)}},{key:"getMaterial",value:function(){return this._matSquare.getMaterial()}},{key:"getVertexNormals",value:function(){return this._matSquare.getVertexNormals()}},{key:"setTextureImage",value:function(e){this._texSquare.setTextureImage(e)}},{key:"getTextureImage",value:function(){return this._texSquare.getTextureImage()}},{key:"getTextureCoords",value:function(){return this._texSquare.getTextureCoords()}}]),r}();e.TextureMaterialSquare=t}(window.bsy),function(e){var t=function(t){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.setTextureImage(e),t.textureCoords=[0,0,1,0,1,1,1,1,0,1,0,0],t}return _inherits(r,e.Square),_createClass(r,[{key:"setTextureImage",value:function(e){this.textureImage=e}},{key:"getTextureImage",value:function(){return this.textureImage}},{key:"getTextureCoords",value:function(){return this.textureCoords}}]),r}();e.TextureSquare=t}(window.bsy),function(e){var t=function(t){function r(e,t){_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return n.camera=e,n.scale=mat4.scale(mat4.create(),mat4.create(),[1,1,1]),n.setTextureImages(t),n}return _inherits(r,e.Cube),_createClass(r,[{key:"_createCubeFaces",value:function(){this.addWorldObject("up",new e.TextureSquare),this.addWorldObject("down",new e.TextureSquare),this.addWorldObject("right",new e.TextureSquare),this.addWorldObject("left",new e.TextureSquare),this.addWorldObject("front",new e.TextureSquare),this.addWorldObject("back",new e.TextureSquare)}},{key:"setTextureImages",value:function(e){if(6!==e.length)throw new Error("Six images must be provided.");this.textureImages=e,this.getWorldObject("up").setTextureImage(e[0]),this.getWorldObject("down").setTextureImage(e[1]),this.getWorldObject("right").setTextureImage(e[2]),this.getWorldObject("left").setTextureImage(e[3]),this.getWorldObject("front").setTextureImage(e[4]),this.getWorldObject("back").setTextureImage(e[5])}},{key:"getTextureImages",value:function(){return this.textureImages}},{key:"getLocation",value:function(){return this.camera.getLocation()}},{key:"getScale",value:function(){return this.scale}},{key:"getTransform",value:function(){return mat4.multiply(mat4.create(),mat4.translate(mat4.create(),mat4.create(),this.getLocation()),this.getScale())}}]),r}();e.SkyBox=t}(window.bsy),function(e){var t=function(t){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;_classCallCheck(this,r);var t=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(e%2!=0)throw new Error("numTriangleStrips must be even.");t.numTriangleStrips=e,t.vertices=[];for(var n=t.buildQuarterDome(e/2),i=vec3.fromValues(0,1,0),o=vec3.fromValues(0,0,1),a=0;a<2;++a)!function(e){for(var r=mat4.fromRotation(mat4.create(),Math.PI*e,o),a=0;a<4;++a)!function(e){var o,a=mat4.fromRotation(mat4.create(),Math.PI/2*e,i);(o=t.vertices).push.apply(o,_toConsumableArray(n.map(function(e){return vec3.transformMat4(vec3.create(),vec3.transformMat4(vec3.create(),e,r),a)})))}(a)}(a);return t.vertices=t.vertices.reduce(function(e,t){return e.concat([t[0],t[1],t[2]])},[]),t}return _inherits(r,e.WorldObject),_createClass(r,[{key:"buildQuarterDome",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=vec3.fromValues(0,0,1),r=vec3.fromValues(0,1,0),n=vec3.fromValues(0,1,0),i=Math.PI/2,o=[],a=[],s=0;s<e+1;++s){for(var c=i/e*s,u=mat4.fromRotation(mat4.create(),c,t),l=s+1,h=[],f=0;f<l;++f){var d=1===l?0:i/(l-1)*f,v=mat4.fromRotation(mat4.create(),d,r);h.push(vec3.transformMat4(vec3.create(),vec3.transformMat4(vec3.create(),n,u),v))}a.push(h)}for(var m=1;m<a.length;++m){for(var g=m,b=m-1,w=0;w<g;++w)o.push(a[m][w]),o.push(a[m-1][w]),o.push(a[m][w+1]);for(var y=0;y<b;++y)o.push(a[m-1][y]),o.push(a[m-1][y+1]),o.push(a[m][y+1])}return o}},{key:"getVertices",value:function(){return this.vertices}}]),r}();e.Sphere=t}(window.bsy),function(e){var t=function(t){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return n.material=e,n}return _inherits(r,e.Sphere),_createClass(r,[{key:"setMaterial",value:function(e){this.material=e}},{key:"getMaterial",value:function(){return this.material}},{key:"getVertexNormals",value:function(){return this.getVertices()}}]),r}();e.MaterialSphere=t}(window.bsy),function(e){var t=function(t){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.Camera;_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return n.setCamera(t),n}return _inherits(r,e.WorldObject),_createClass(r,[{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(e){return this.camera=e,this}}]),r}();e.World=t}(window.bsy);